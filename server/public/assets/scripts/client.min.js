/*! ticket-system 2016-04-17 */
var app=angular.module("ticketApp",[]);app.controller("TicketController",["$http",function(a){var b=this;b.newTicket={},b.ticketList=[],b.submitTicket=function(){b.newTicket.editMode=!1,b.newTicket.disableEdit=!1,a.post("/new",b.newTicket).then(function(a){console.log("Ticket submitted successfully"),b.getAllTickets()})},b.getAllTickets=function(){a.get("/all").then(function(a){console.log("Tickets retrieved:",a),b.ticketList=a.data,b.ticketList.map(function(a){var b=moment(a.dateCreated).format("dddd, MMMM Do YYYY, h:mm:ss a");a.dateCreatedString=b;var c=moment(a.dateUpdated).format("dddd, MMMM Do YYYY, h:mm:ss a");a.dateUpdatedString=c})})},b.removeTicket=function(c){console.log("ticket remove function ran"),a["delete"]("/remove/"+c._id).then(function(a){console.log("Ticket removed"),b.getAllTickets()})},b.editThisTicket=function(a){b.editTicket=a,b.editTicket.editMode=!0,b.disableEdits()},b.saveTicket=function(){console.log(b.editTicket),b.editTicket.editMode=!1,a.put("/update",b.editTicket).then(function(a){console.log("Ticket updated"),b.enableEdits(),b.editTicket={},b.getAllTickets()})},b.disableEdits=function(){b.ticketList.map(function(a){a.editMode||(a.disableEdit=!0)})},b.enableEdits=function(){b.ticketList.map(function(a){a.disableEdit&&(a.disableEdit=!1)})},b.getAllTickets()}]);